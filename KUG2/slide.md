## Go初めて2ヶ月くらいの  
## 初心者がソシャゲっぽいのを作ってみた(仮

---

# お前だれよ？

--

![俺だよ](images/profile.jpg "俺だよ")

* HN：しょーさ [(syo_sa1982)](http://twitter.com/syo_sa1982)
* 本名：藤井陽介
* DeNA Games Osaka
* 元ぺちぱーで今はWebフロントエンドメイン
* Go歴は初心者に毛が生えた程度
* 仕事でGo書きたい(願望

---

# 今日のお題

--

Goでゲームサーバー(っぽい何か)を作ってる時に    
やったことととか、疑問に思ったことを適当にしゃべります。

---

# で、どんなの作った？

--

* クライアント側はUnity
    * 一応スマホで動かすこと前提
    
* Goでサーバー側の処理
    * httpでリクエスト受け取ってjsonで返すだけ
    * ゲームロジックも基本サーバーで完結したい
        * 戦闘画面とかだとクライアント側で処理？
    * 使ってるライブラリはgojiとgorm
    
---

# やったこと

--

* 正直、Webサーバーの延長線上のことしかしてない。

* 作った機能はユーザー登録からキャラ作成まで
    1. Unity側でUUIDを発行してユーザー認証/登録
    1. Goで乱数を生成してキャラのステータスを生成
        * 乱数はTRPGで言うと例えば3D6(6面ダイスを3回)みたいな感じで使いたかった
    1. サーバーからのレスポンスを画面に出したいときはjsonでhttp通信使って送信
    1. gojiでURLのルーティングとか
    1. gormでDBに保存

* メインのゲーム本体は、まだ作ってない

---

# いきなりまとめ(と言うか感想

--

* ぱっと見Cっぽいけど、割りと手軽に書けると思った(小並感

* 片手間にgoを学習し始めてから何か作りだすまでそんなに掛からなかった気がする

* 乱数生成して似たようなことを過去にC++でやろうとしてたけど、goの方がコード量少なかった。

--

* Classが無かったり、型名が後ろだったり戸惑うことは有ったけど、慣れると気にならなくなる
    * 継承も無いけど、構造体を入れ子にすることで代用すればいいかな。

* goji使ってるけどルーティングにしか使ってないし、ORM以外は標準のパッケージで行ける気がする

* goroutine使ってないけど、サイズの大きいrange(配列)をforで回してる所があるので、そこで使えば処理早くなるかも？

---

# 疑問点とか

--

* Unity側でUUID生成してサーバーに保存してるけど、セキュリティ対策とかどうしてるんだろう？
    * 送受信前に暗号化/復号くらいしか思いつかなかった
    
* jsonをUnity側に投げる時、基本mapを使って必要に応じて(※)struct使ってるけど、最初からAPI返す為のstruct作った方が良いのか？
    * ※)例えば型の違うmapを複数送信したい時とか
      
* Unityから送信する時にWWWFormクラスを使ってるけど、stringでしか送信できないっぽいので、他にいい方法無いか？
    * これGoの疑問じゃないというのはさておき…

---

# 今後やること

--

* そろそろサーバとか借りて、アプリも実機で見れるようにしたい。
    * GAEにするかさくらにするかで迷ってる
* goroutine使ってないので、処理重くなりそうな所には使っていきたい
* 肝心なゲーム全体の流れをまだ考えて無かったので、何か考える
    * 内容によってはTCP通信要るかも？
        * その辺りはこの後の発表者の誰かが(ry
---

## ご静聴有難うございました


